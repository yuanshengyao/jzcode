#!/usr/bin/env node

const path = require('path');
const program = require('commander');
// const download = require('download-git-repo');
// const handlebars = require('handlebars');
// const inquirer = require('inquirer');
const ora = require('ora');
const chalk = require('chalk');
const symbols = require('log-symbols');

const { copyAllFile, deleteAllFile } = require('./common/utils/files');

console.log('开始构建项目');
const spinner = ora('正在运行中...');
spinner.start();

const rootPath = path.resolve(__dirname, 'view');
const commonPath = path.resolve(__dirname, 'common/dist');
const commonTargetPath = path.resolve(__dirname, 'view/common');
const jzVuePath = path.resolve(__dirname, 'jzvue/dist');
const jzVueTargetPath = path.resolve(__dirname, 'view/jzvue');

deleteAllFile(rootPath, {
  exclude: {
    files: ['.gitignore'],
    dirs: ['view']
  }
});
setTimeout(() => {
  if(Math.random() < 1) {
    copyAllFile(commonPath, commonTargetPath);
    copyAllFile(jzVuePath, jzVueTargetPath);
    spinner.succeed('运行成功');
    console.log(symbols.success ,chalk.green('项目构建成功'));
  }else {
    spinner.fail('运行失败');
    console.log(symbols.error, chalk.red('项目构建失败'));
  }
}, 3000);
